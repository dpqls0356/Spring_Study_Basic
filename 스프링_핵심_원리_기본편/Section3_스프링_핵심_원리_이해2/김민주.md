## πΏ μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°

- μ”κµ¬μ‚¬ν•­ λ³€κ²½ : κ³ μ •ν• μΈμ„ μ •λ¥ ν• μΈμΌλ΅ ν• μΈ μ •μ±… λ³€κ²½

```java
public class RateDiscountPolicy implements DiscountPolicy {
    private int discountPercent = 10;

    @Override
    public int discount(Member member, int price) {
        if (member.getGrade() == Grade.VIP) {
            return price * discountPercent / 100;
        }
        return 0;
    }
}
```

- ν…μ¤νΈ μλ™ μƒμ„± λ‹¨μ¶•ν‚¤ : `ctrl + shift + t`
  - Testing libraryκ°€ JUnit5μΈμ§€ ν™•μΈ

```java
class RateDiscountPolicyTest {

    RateDiscountPolicy discountPolicy = new RateDiscountPolicy();

    @Test
    @DisplayName("VIPλ” 10% ν• μΈμ΄ μ μ©λμ–΄μ•Ό ν•λ‹¤")
    void vip_o() {
        //given
        Member member = new Member(1L, "memberVIP", Grade.VIP);

        //when
        int discount = discountPolicy.discount(member, 10000);

        //then
        // static import μ¶”μ²
        assertThat(discount).isEqualTo(1000);
    }

    @Test
    @DisplayName("VIPκ°€ μ•„λ‹λ©΄ ν• μΈμ΄ μ μ©λμ§€ μ•μ•„μ•Ό ν•λ‹¤")
    void vip_x() {
        //given
        Member member = new Member(2L, "memberBASIC", Grade.BASIC);

        //when
        int discount = discountPolicy.discount(member, 10000);

        //then
        assertThat(discount).isEqualTo(0);
    }

}
```

## πΏ μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 

```java
public class OrderServiceImpl implements OrderService{

    //    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
    ...

}
```

> μ—­ν• κ³Ό κµ¬ν„ λ¶„λ¦¬, λ‹¤ν•μ„± ν™μ©, μΈν„°νμ΄μ¤ κµ¬ν„ κ°μ²΄ λ¶„λ¦¬...  
>  OCP, DIPλ¥Ό μ¶©μ‹¤ν•κ² μ¤€μν• κ²ƒ κ°™μ§€λ§ _μ•„λ‹λ‹¤_.

- ν΄λμ¤ μμ΅΄κ΄€κ³„λ¥Ό λ¶„μ„ν•μ€μ„ λ• μ¶”μƒ(μΈν„°νμ΄μ¤)λΏλ§ μ•„λ‹λΌ **κµ¬μ²΄(κµ¬ν„) ν΄λμ¤μ—λ„ μμ΅΄**
  - **DIP μ„λ°**
- `FixDiscountPolicy`λ¥Ό `RateDiscountPolicy`λ΅ λ³€κ²½ν•  λ• `OrderServiceImpl`μ μ½”λ“ λ³€κ²½ λ°μƒ
  - κµ¬μ²΄ ν΄λμ¤μ™€ μμ΅΄ κ΄€κ³„κ°€ μλ‹¤.
  - **OCP μ„λ°**

### ν•΄κ²°λ°©λ²•

- μΈν„°νμ΄μ¤λ§ μμ΅΄ν•λ„λ΅ μ„¤κ³„μ™€ μ½”λ“ λ³€κ²½
  - `private final DiscountPolicy discountPolicy;`
  - κµ¬ν„μ²΄λ¥Ό μ΄κΈ°ν™”ν•μ§€ μ•μ•μΌλ―€λ΅ Null Pointer Exception λ°μƒ
- λ„κµ°κ°€κ°€ κµ¬ν„ κ°μ²΄λ¥Ό λ€μ‹  μƒμ„±ν•κ³  μ£Όμ…ν•λ” λ°©λ²•μΌλ΅ ν•΄κ²°

## πΏ κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬

- μΈν„°νμ΄μ¤μ— λ§λ” κµ¬ν„μ²΄λ¥Ό μ„ νƒν•λ” κ²ƒμ€ λ„κ°€ ν•΄μ•Όν• κΉ?
  - μ΄μ „ μμ  μ½”λ“μ—μ„λ” κµ¬ν„μ²΄κ°€ μΈν„°νμ΄μ¤μ κµ¬ν„μ²΄λ¥Ό μ„ νƒν•΄μ„ ν• λ‹Ή
  - λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ² λ¨
- κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•μ—¬ λ³ΈμΈμ μ—­ν• λ§ μν–‰ν•λ„λ΅ ν•μ
  - κµ¬ν„μ²΄λ” κµ¬ν„μ²΄μ μ—­ν• λ§ ν•κ³  μΈν„°νμ΄μ¤μ— λ§λ” κµ¬ν„μ²΄λ¥Ό ν• λ‹Ήν•λ” μ±…μ„μ„ λ¶„λ¦¬

### AppConfig

- μ• ν”λ¦¬μΌ€μ΄μ…μ μ „μ²΄ λ™μ‘λ°©μ‹μ„ κµ¬μ„±ν•κΈ° μ„ν•΄μ„ **κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±**ν•κ³  **μ—°κ²°**ν•λ” μ±…μ„μ„ κ°€μ§€λ” λ³„λ„μ μ„¤μ • ν΄λμ¤
  - κ°μ²΄ μΈμ¤ν„΄μ¤μ μ°Έμ΅°(λ νΌλ°μ¤)λ¥Ό **μƒμ„±μλ¥Ό ν†µν•΄μ„ μ£Όμ…(μ—°κ²°)**
    - μμ΅΄κ΄€κ³„ μ£Όμ…, μμ΅΄μ„± μ£Όμ…(Dependency Injection, DI)
  - κµ¬ν„μ²΄μ— μ–΄λ–¤ κµ¬ν„μ²΄κ°€ μ£Όμ…λ μ§€λ” μ¤λ΅μ§€ μ™Έλ¶€μ—μ„ κ²°μ •
  - κµ¬ν„μ²΄λ” μ‹¤ν–‰μ—λ§ μ§‘μ¤‘
- **κ΄€μ‹¬μ‚¬ λ¶„λ¦¬** : κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ—­ν• κ³Ό μ‹¤ν–‰ν•λ” μ—­ν• μ΄ λ…ν™•ν λ¶„λ¦¬

```java
public class AppConfig {
    // μμ΅΄μ„± μ£Όμ… - μƒμ„±μ μ£Όμ…
    public OrderService orderService() {
        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
    }

}
```

```java
public class OrderServiceImpl implements OrderService {

    private  MemberRepository memberRepository; // μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ (DIP λ§μ΅±)
    private  DiscountPolicy discountPolicy ;

    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

}
```

```java
AppConfig appConfig = new AppConfig();
// MemberService memberService = new MemberServiceImpl();
MemberService memberService = appConfig.memberService();
```

### πΏ AppConfig λ¦¬ν©ν„°λ§

- μ½”λ“ μ¤‘λ³µκ³Ό μ—­ν• μ— λ”°λ¥Έ κµ¬ν„μ΄ μ λ³΄μ΄μ§€ μ•λ” λ¬Έμ  μμ •
- Extract Mode λ‹¨μ¶•ν‚¤ : `ctrl + alt + m`

```java
public class AppConfig {
    public MemberService memberService() {
        // μƒμ„±μ μ£Όμ…
        return new MemberServiceImpl(memberRepository());
    }

    // μ¤‘λ³µ μ κ±°
    private static MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

    public OrderService orderService() {
        // μ—­ν• μ„ λ…ν™•ν•κ²
        return new OrderServiceImpl(memberRepository(), discountPolicy());
    }

    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();
    }
}
```

## πΏ μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©

- ν• μΈ μ •μ±…μ„ λ°”κΎΈλ ¤λ©΄ `AppConfig`μ—μ„ ν• μΈ μ •μ±… μ½”λ“λ§ λ³€κ²½ν•λ©΄ λ¨
  - κµ¬μ„± μ”μ† μ½”λ“λ§ λ³€κ²½ λ°μƒ, **μ‚¬μ© μμ—­(κµ¬ν„μ²΄)μ€ λ³€κ²½ λ°μƒν•μ§€ μ•μ**
- OCPμ™€ DIP λ¨λ‘ λ§μ΅±

```java
public DiscountPolicy discountPolicy() {
    return new RateDiscountPolicy();
}
```

## πΏ μ „μ²΄ νλ¦„ μ •λ¦¬

1. μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°
   - λ‹¤ν•μ„± λ•λ¶„μ— μƒλ΅μ΄ μ •λ¥  ν• μΈ μ •μ±…μ„ μ¶”κ°€λ΅ κ°λ°ν•λ” κ²ƒμ—λ” λ¬Έμ κ°€ μ—†μ—μ
2. μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 
   - μƒλ΅ κ°λ°ν• μ •λ¥  ν• μΈ μ •μ±…μ„ μ μ©ν•λ ¤κ³  ν•λ‹ **ν΄λΌμ΄μ–ΈνΈ μ½”λ“**μΈ μ£Όλ¬Έ μ„λΉ„μ¤ κµ¬ν„μ²΄λ„ ν•¨κ» λ³€κ²½ ν•„μ”(DIP μ„λ°)
3. κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬
   - κΈ°μ΅΄ κµ¬ν„μ²΄μ—μ„ **κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±**ν•κ³  **μ—°κ²°**ν•λ” μ±…μ„ λ¶„λ¦¬
4. `AppConfig` λ¦¬ν©ν„°λ§
   - κµ¬μ„± μ •λ³΄μ—μ„ μ—­ν• κ³Ό κµ¬ν„μ„ λ…ν™•ν•κ² λ¶„λ¦¬, μ¤‘λ³µ μ κ±°
5. μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©
   - μ• ν”λ¦¬μΌ€μ΄μ…μ΄ ν¬κ² **μ‚¬μ© μμ—­**κ³Ό **κµ¬μ„±(Configuration) μμ—­**μΌλ΅ λ¶„λ¦¬λ¨

## πΏ μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™μ μ μ©

### SRP λ‹¨μΌ μ±…μ„ μ›μΉ™

- **κ΄€μ‹¬μ‚¬ λ¶„λ¦¬**
  - ν΄λΌμ΄μ–ΈνΈ κ°μ²΄κ°€ μ§μ ‘ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±, μ—°κ²°, μ‹¤ν–‰ν•λ” λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ³  μλ” λ¬Έμ κ°€ μμ—μ
  - κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ±…μ„μ€ `AppConfig`κ°€ λ‹΄λ‹Ή
  - μ‹¤ν–‰ν•λ” μ±…μ„μ€ ν΄λΌμ΄μ–ΈνΈ κ°μ²΄κ°€ λ‹΄λ‹Ή

### DIP μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™

- **μμ΅΄μ„± μ£Όμ…**
  - `AppConfig`μ μƒμ„±μ μ£Όμ…μ„ ν†µν•΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“κ°€ μ¶”μƒν™” μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“ λ³€κ²½

### OCP

- **λ‹¤ν•μ„±** μ‚¬μ©, ν΄λΌμ΄μ–ΈνΈ **DIP** λ§μ΅±
  - `AppConfig`κ°€ μμ΅΄κ΄€κ³„λ¥Ό ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μ£Όμ…
  - ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” λ³€κ²½ν•μ§€ μ•μ•„λ„ λ¨

## πΏ IoC, DI, κ·Έλ¦¬κ³  μ»¨ν…μ΄λ„

- μ μ–΄μ μ—­μ „(IoC) : ν”„λ΅κ·Έλ¨μ μ μ–΄ νλ¦„μ„ μ§μ ‘ μ μ–΄ν•λ” κ²ƒμ΄ μ•„λ‹λΌ μ™Έλ¶€μ—μ„ κ΄€λ¦¬

### ν”„λ μ„μ›ν¬ vs λΌμ΄λΈλ¬λ¦¬

- ν”„λ μ„μ›ν¬ : ν”„λ μ„μ›ν¬κ°€ λ‚΄κ°€ μ‘μ„±ν• μ½”λ“λ¥Ό μ μ–΄ν•κ³  λ€μ‹  μ‹¤ν–‰
- λΌμ΄λΈλ¬λ¦¬ : λ‚΄κ°€ μ‘μ„±ν• μ½”λ“κ°€ μ§μ ‘ μ μ–΄μ νλ¦„μ„ λ‹΄λ‹Ή

### μμ΅΄κ΄€κ³„ μ£Όμ…(Dependency Injection)

- **μ •μ μΈ ν΄λμ¤ μμ΅΄ κ΄€κ³„**
  - ν΄λμ¤κ°€ μ‚¬μ©ν•λ” import μ½”λ“λ¥Ό λ³΄κ³  μμ΅΄κ΄€κ³„ νλ‹¨
  - μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν•μ§€ μ•κ³ λ„ λ¶„μ„ κ°€λ¥
- **μ‹¤ν–‰ μ‹μ μ— κ²°μ •λλ” λ™μ μΈ κ°μ²΄(μΈμ¤ν„΄μ¤) μμ΅΄ κ΄€κ³„**
  - **μμ΅΄κ΄€κ³„ μ£Όμ…**
    - μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ‹μ (λ°νƒ€μ„)μ— μ™Έλ¶€μ—μ„ μ‹¤μ  κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  ν΄λΌμ΄μ–ΈνΈμ— μ „λ‹¬ν•μ—¬ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ μ‹¤μ  μμ΅΄κ΄€κ³„ μ—°κ²°
    - ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό λ³€κ²½ν•μ§€ μ•κ³  ν΄λΌμ΄μ–ΈνΈκ°€ νΈμ¶ν•λ” λ€μƒμ νƒ€μ… μΈμ¤ν„΄μ¤ λ³€κ²½ κ°€λ¥
    - μ •μ μΈ ν΄λμ¤ μμ΅΄κ΄€κ³„λ¥Ό λ³€κ²½ν•μ§€ μ•κ³  λ™μ μΈ κ°μ²΄ μΈμ¤ν„΄μ¤ μμ΅΄κ΄€κ³„ λ³€κ²½

### IoC μ»¨ν…μ΄λ„, DI μ»¨ν…μ΄λ„

- κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ΄€λ¦¬ν•λ©΄μ„ μμ΅΄κ΄€κ³„λ¥Ό μ—°κ²°
  - `AppConfig`
- μμ΅΄ κ΄€κ³„ μ£Όμ…μ— μ΄μ μ„ λ§μ¶°μ„ μ£Όλ΅ **DI μ»¨ν…μ΄λ„**λΌκ³  λ¶€λ¦„

## πΏ μ¤ν”„λ§μΌλ΅ μ „ν™ν•κΈ°

- `@Configuration`
  - μ„¤μ •(κµ¬μ„±) μ •λ³΄λ΅ μ‚¬μ©
- `@Bean`
  - `@Bean`μ΄ μ μΈ λ©”μ„λ“λ¥Ό λ¨λ‘ νΈμ¶ν•΄μ„ λ°ν™ κ°μ²΄λ¥Ό μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λ“±λ΅
  - λ©”μ„λ“μ λ…μ„ μ¤ν”„λ§ λΉμ μ΄λ¦„μΌλ΅ μ‚¬μ©
  - κΈ°μ΅΄μ—λ” κ°λ°μκ°€ μ§μ ‘ μλ°”μ½”λ“λ΅ λ¨λ“  κ²ƒμ„ ν–λ‹¤λ©΄ μ¤ν”„λ§μ„ μ‚¬μ©ν•λ©΄ μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— λ“±λ΅ν•κ³  μ°Ύμ•„μ„ μ‚¬μ©

```java
@Configuration
public class AppConfig {

    @Bean
    public MemberService memberService() {
        // μƒμ„±μ μ£Όμ…
        return new MemberServiceImpl(memberRepository());
    }

    @Bean
    public static MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }

}
```

```java
ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
// λ©”μ†λ“ μ΄λ¦„κ³Ό νƒ€μ…μΌλ΅ κΊΌλ‚΄λ©΄ λ¨
 MemberService memberService = applicationContext.getBean("memberService", MemberService.class);
```
